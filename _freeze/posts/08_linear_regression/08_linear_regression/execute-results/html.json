{
  "hash": "e66f1472260e8980d8201bb308f42a6a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"8: Linear Regression\"\nauthor: \"Derek Sollberger\"\ndate: \"2024-09-26\"\nformat:\n  html:\n    toc: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"gt\")        #great tables\nlibrary(\"HistData\")  #historical data sets\nlibrary(\"tidyverse\") #tools for data wrangling and visualization\n\nliquor_df <- data.frame(\n  year = 2014:2022,\n  LLV = c(129, 54, 103, 50, 15, 10, 18, 49,57)\n)\nMM_df <- data.frame(\n  S = c(0.08, 0.12, 0.54, 1.23, 1.82, 2.72, 4.94, 10.00),\n  v = c(0.15, 0.21, 0.7, 1.1, 1.3, 1.5, 1.7, 1.8)\n)\n```\n:::\n\n\n\n\n# SML 201\n\n## Start\n\n:::: {.columns}\n\n::: {.column width=\"30%\"}\n* **Goal**: Make predictions\n\n* **Objective**: Perform linear regression and compute coefficients of determination\n:::\n\n::: {.column width=\"10%\"}\n\n:::\n\n::: {.column width=\"60%\"}\n![linear regression](xkcd_2533.png)\n\n* image source: [XKCD](https://www.explainxkcd.com/wiki/index.php/2533:_Slope_Hypothesis_Testing)\n:::\n\n::::\n\n\n# Campus Example\n\n:::: {.panel-tabset}\n\n## Description\n\n:::: {.columns}\n\n::: {.column width=\"45%\"}\nThe following data on judicial referrals for liquor law violations come from the Princeton University [Annual Security and Fire Safety Report](https://publicsafety.princeton.edu/information/monthlyannual-data)  (in and around the main campus)\t\n\n![Cleary Act Report](Cleary_Report.png)\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"45%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"grhpqmmume\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#grhpqmmume table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#grhpqmmume thead, #grhpqmmume tbody, #grhpqmmume tfoot, #grhpqmmume tr, #grhpqmmume td, #grhpqmmume th {\n  border-style: none;\n}\n\n#grhpqmmume p {\n  margin: 0;\n  padding: 0;\n}\n\n#grhpqmmume .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#grhpqmmume .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#grhpqmmume .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#grhpqmmume .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#grhpqmmume .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#grhpqmmume .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#grhpqmmume .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#grhpqmmume .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#grhpqmmume .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#grhpqmmume .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#grhpqmmume .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#grhpqmmume .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#grhpqmmume .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#grhpqmmume .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#grhpqmmume .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#grhpqmmume .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#grhpqmmume .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#grhpqmmume .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#grhpqmmume .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#grhpqmmume .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#grhpqmmume .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#grhpqmmume .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#grhpqmmume .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#grhpqmmume .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#grhpqmmume .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#grhpqmmume .gt_left {\n  text-align: left;\n}\n\n#grhpqmmume .gt_center {\n  text-align: center;\n}\n\n#grhpqmmume .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#grhpqmmume .gt_font_normal {\n  font-weight: normal;\n}\n\n#grhpqmmume .gt_font_bold {\n  font-weight: bold;\n}\n\n#grhpqmmume .gt_font_italic {\n  font-style: italic;\n}\n\n#grhpqmmume .gt_super {\n  font-size: 65%;\n}\n\n#grhpqmmume .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#grhpqmmume .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#grhpqmmume .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#grhpqmmume .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#grhpqmmume .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#grhpqmmume .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#grhpqmmume .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#grhpqmmume .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#grhpqmmume div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal\" style>Liquor Law Violiations</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>(judicial referrals)</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"year\">year</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"LLV\">LLV</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"year\" class=\"gt_row gt_center\" style=\"background-color: #FCFFA4; color: #000000;\">2014</td>\n<td headers=\"LLV\" class=\"gt_row gt_center\" style=\"background-color: #FCFFA4; color: #000000;\">129</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_center\" style=\"background-color: #87216B; color: #FFFFFF;\">2015</td>\n<td headers=\"LLV\" class=\"gt_row gt_center\" style=\"background-color: #87216B; color: #FFFFFF;\">54</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_center\" style=\"background-color: #FB9C06; color: #000000;\">2016</td>\n<td headers=\"LLV\" class=\"gt_row gt_center\" style=\"background-color: #FB9C06; color: #000000;\">103</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_center\" style=\"background-color: #791D6D; color: #FFFFFF;\">2017</td>\n<td headers=\"LLV\" class=\"gt_row gt_center\" style=\"background-color: #791D6D; color: #FFFFFF;\">50</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_center\" style=\"background-color: #060418; color: #FFFFFF;\">2018</td>\n<td headers=\"LLV\" class=\"gt_row gt_center\" style=\"background-color: #060418; color: #FFFFFF;\">15</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_center\" style=\"background-color: #000004; color: #FFFFFF;\">2019</td>\n<td headers=\"LLV\" class=\"gt_row gt_center\" style=\"background-color: #000004; color: #FFFFFF;\">10</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_center\" style=\"background-color: #0C0826; color: #FFFFFF;\">2020</td>\n<td headers=\"LLV\" class=\"gt_row gt_center\" style=\"background-color: #0C0826; color: #FFFFFF;\">18</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_center\" style=\"background-color: #761C6D; color: #FFFFFF;\">2021</td>\n<td headers=\"LLV\" class=\"gt_row gt_center\" style=\"background-color: #761C6D; color: #FFFFFF;\">49</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_center\" style=\"background-color: #912568; color: #FFFFFF;\">2022</td>\n<td headers=\"LLV\" class=\"gt_row gt_center\" style=\"background-color: #912568; color: #FFFFFF;\">57</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"> Princeton University, Main Campus</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n:::\n\n::::\n\n## gt code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliquor_df |>\n  gt() |>\n  cols_align(align = \"center\") |>\n  tab_footnote(footnote = \"Princeton University, Main Campus\") |>\n  tab_header(\n    title = \"Liquor Law Violiations\",\n    subtitle = \"(judicial referrals)\"\n  ) |>\n  tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_column_labels()\n  ) |>\n  data_color(\n    columns = LLV,\n    target_columns = everything(),\n    palette = \"inferno\",\n    reverse = FALSE\n  )\n```\n:::\n\n\n\n::::\n\n## Linear Regression in R\n\n* response variable (y): `LLV`\n* explanatory variable (x): `year`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlin_fit <- lm(LLV ~ year, data = liquor_df)\n```\n:::\n\n\n\nIn a model equation, the tilde `~` is read as \"explained by\".  In this model, we can say that the response variable `LLV` is explained by the `year`.\n\n## Prediction in R\n\nWe use the `predict` function where the input is a data frame.  In this example, we are predicting the number of judicial referrals for liquor law violations in the year 2023.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyhat <- predict(lin_fit,\n                newdata = data.frame(year = 2023))\n```\n:::\n\n\n\n## Validation\n\nIn this simple example, we know the true answer: there were 262 judicial referrals for liquor law violations in the year 2023\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# true value\ny <- 262\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# absolute error\nabs(y - yhat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       1 \n250.8611 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# relative error\nabs(y - yhat) / y\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1 \n0.9574852 \n```\n\n\n:::\n:::\n\n\n\nWhy was the prediction so inaccurate?\n\n\n# SSE\n\n## Scatterplot\n\nIt is a good idea to look at the data (when practical).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliquor_df |>\n  ggplot() +\n  geom_point(aes(x = factor(year), y = LLV),\n             size = 4, color = \"black\") +\n  labs(title = \"Liquor Law Violations\",\n       subtitle = \"Princeton University, main campus\",\n       caption = \"SML 201\",\n       x = \"year\", y = \"judicial referrals\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_linear_regression_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n## Smooth\n\nOn the visual size, linear regression summarizes a scatterplot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliquor_df |>\n  ggplot(aes(x = year, y = LLV)) +\n  geom_point(size = 4, color = \"black\") +\n  geom_smooth(formula = \"y ~ x\", method = \"lm\", se = FALSE,\n              color = \"blue\", linewidth = 2) +\n  labs(title = \"Liquor Law Violations\",\n       subtitle = \"Princeton University, main campus\",\n       caption = \"SML 201\",\n       x = \"year\", y = \"judicial referrals\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_linear_regression_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## Centroid\n\nClaim: a linear regression model goes through the centroid \n\n$$(\\bar{x}, \\bar{y})$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxbar <- mean(liquor_df$year)\nybar <- mean(liquor_df$LLV)\n\nliquor_df |>\n  ggplot(aes(x = year, y = LLV)) +\n  geom_point(size = 4, color = \"black\") +\n  geom_vline(xintercept = xbar, color = \"green\") +\n  geom_hline(yintercept = ybar, color = \"green\") +\n  geom_smooth(formula = \"y ~ x\", method = \"lm\", se = FALSE,\n              color = \"blue\", linewidth = 2) +\n  labs(title = \"Linear Regression\",\n       subtitle = \"A linear regression model goes through the centroid \",\n       caption = \"SML 201\",\n       x = \"year\", y = \"judicial referrals\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_linear_regression_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## Vector Space\n\nHow was the line drawn?\n\n![Where to draw the line?](many_splits.gif)\n\n## Linear Model\n\n$$\\hat{y} = a + bx$$\n\n* $\\hat{y}$: predicted value\n* $a$: intercept\n* $b$: slope\n\n## Residuals\n\nA *residual* is the difference between a predicted value and its true value.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nliquor_df <- liquor_df |>\n  mutate(predictions = predict(lin_fit,\n                               newdata = data.frame(year = liquor_df$year)),\n         residuals = predictions - LLV)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nliquor_df |>\n  ggplot(aes(x = year, y = LLV)) +\n  geom_segment(aes(x = year, y = predictions, \n                   xend = year, yend = LLV), \n               color = \"purple\", linewidth = 3) +\n  geom_point(size = 4, color = \"black\") +\n  geom_smooth(formula = \"y ~ x\", method = \"lm\", se = FALSE,\n              color = \"blue\", linewidth = 2) +\n  geom_point(aes(x = year, y = predictions),\n             color = \"red\", size = 4) +\n  labs(title = \"Linear Regression\",\n       subtitle = \"black: true values\\nred: predictions\\npurple: residuals\",\n       caption = \"SML 201\",\n       x = \"year\", y = \"judicial referrals\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_linear_regression_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n## Corollary: Residual Balance\n\nClaim: the average of the residuals is zero\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(liquor_df$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.616879e-12\n```\n\n\n:::\n:::\n\n\n\n## Method of Least Squares\n\n**Idea**: The *best-fit* line is where the sum-of-squared residuals is minimized.\n\n$$E(a,b) = \\sum_{i=1}^{n} (y_{i} - a - bx_{i})^{2}$$\n\n**Claim**: $$a = \\frac{ (\\sum y_{i})(\\sum x_{i}^{2}) - (\\sum x_{i})(\\sum x_{i}y_{i}) }{ n\\sum x_{i}^{2} - (\\sum x_{i})^{2} }, \\quad b = \\frac{ n\\sum x_{i}y_{i} - (\\sum x_{i})(\\sum y_{i}) }{ n\\sum x_{i}^{2} - (\\sum x_{i})^{2} }$$\n\n::: {.callout-note collapse=\"true\"}\n## (optional) Proof\n\nSearch for a critical point by setting the partial derivatives (along with the Chain Rule) equal to zero.\n\n$$0 = \\frac{\\partial E}{\\partial a} = -2\\sum_{i = 1}^{n} (y_{i} - a - bx_{i}) = 2an + 2b\\sum_{i = 1}^{n}x_{i} - 2\\sum_{i = 1}^{n} y_{i}$$\n$$0 = \\frac{\\partial E}{\\partial b} = -2\\sum_{i = 1}^{n} (y_{i} - a - bx_{i})x_{i} = 2a\\sum_{i = 1}^{n}x_{i} + 2b\\sum_{i = 1}^{n}x_{i}^{2} - 2\\sum_{i = 1}^{n} x_{i}y_{i}$$\n\nCreate a matrix system of equations.\n\n$$\\left[  \\begin{array}{cc}\n  n & \\sum_{i = 1}^{n}x_{i} \\\\\n  \\sum_{i = 1}^{n}x_{i} & \\sum_{i = 1}^{n}x_{i}^{2} \\\\\n  \\end{array}\\right]\n  \\left[  \\begin{array}{c}  a \\\\ b \\end{array}\\right]\n  =\n  \\left[  \\begin{array}{c}  \\sum_{i = 1}^{n} y_{i} \\\\ \\sum_{i = 1}^{n} x_{i}y_{i} \\end{array}\\right]\n  $$\n\n\nEmploy a matrix inverse.\n\n$$\\begin{array}{rcl}\n  \\left[  \\begin{array}{c}  a \\\\ b \\end{array}\\right] & = & \n  \\left[  \\begin{array}{cc}\n  n & \\sum_{i = 1}^{n}x_{i} \\\\\n  \\sum_{i = 1}^{n}x_{i} & \\sum_{i = 1}^{n}x_{i}^{2} \\\\\n  \\end{array}\\right]^{-1}\\left[  \\begin{array}{c}  \\sum_{i = 1}^{n} y_{i} \\\\ \\sum_{i = 1}^{n} x_{i}y_{i} \\end{array}\\right] \\\\\n  \n  ~ & ~ & ~ \\\\\n  \n  \\left[  \\begin{array}{c}  a \\\\ b \\end{array}\\right] & = & \\frac{1}{n\\sum x_{i}^{2} - (\\sum x_{i})^{2}} \\left[  \\begin{array}{cc}\n  \\sum_{i = 1}^{n}x_{i}^{2} & -\\sum_{i = 1}^{n}x_{i} \\\\\n  -\\sum_{i = 1}^{n}x_{i} & n \\\\\n  \\end{array}\\right]  \\left[  \\begin{array}{c}  \\sum_{i = 1}^{n} y_{i} \\\\ \\sum_{i = 1}^{n} x_{i}y_{i} \\end{array}\\right] \\\\\n  \n  ~ & ~ & ~ \\\\\n  \n  \\left[  \\begin{array}{c}  a \\\\ b \\end{array}\\right] & = & \\frac{1}{n\\sum x_{i}^{2} - (\\sum x_{i})^{2}} \n  \\left[  \\begin{array}{c}  (\\sum y_{i})(\\sum x_{i}^{2}) - (\\sum x_{i})(\\sum x_{i}y_{i}) \\\\  n\\sum x_{i}y_{i} - (\\sum x_{i})(\\sum y_{i}) \\end{array}\\right] \\\\\n\\end{array}$$\n\n:::\n\n## LM\n\n$$\\hat{y} = a + bx$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(LLV ~ year, data = liquor_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = LLV ~ year, data = liquor_df)\n\nCoefficients:\n(Intercept)         year  \n   17307.79        -8.55  \n```\n\n\n:::\n:::\n\n\n\nFor every increase in year, the number of judicial referrals decreases by 8.55.\n\n### Prediction\n\nPredict the number of judicial referrals for liquor law violations in the year 2023.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na <- summary(lin_fit)$coefficients[1]\nb <- summary(lin_fit)$coefficients[2]\n\na + b*(2023)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11.13889\n```\n\n\n:::\n\n```{.r .cell-code}\npredict(lin_fit, newdata = data.frame(year = 2023))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       1 \n11.13889 \n```\n\n\n:::\n:::\n\n\n\n# Coefficient of Determination\n\nWe want a measurement that can assure us of how useful a model will be for predictions.\n\n## Definition\n\nThe **coefficient of determination** is defined as\n\n$$R^{2} = \\frac{\\text{explained variance}}{\\text{total variance}}$$\n\nFor analysis of variance:\n\n* explained variation: $\\sum(\\hat{y} - \\bar{y})^{2}$\n* unexplained variation: $\\sum(y - \\hat{y})^{2}$\n* total variation = explained variation + unexplained variation\n$$\\sum(y - \\bar{y})^{2} = \\sum(\\hat{y} - \\bar{y})^{2} + \\sum(y - \\hat{y})^{2}$$\n\n## Inference\n\nWhy is that denoted \"$R^2$\"? For linear regression, the coefficient of determination is literally the square of the correlation coefficient ($r$)\n\n* correlation $-1 \\leq r \\leq 1$ implies coefficient of determination\n$$0 \\leq R^{2} \\leq 1$$\n* want more \"explained variation\", thus higher $R^{2}$ means a better model\n\n## Guidelines\n\n:::: {.columns}\n\n::: {.column width=\"60%\"}\nIn this course, we will simply follow the Pearson suggestions for interpreting coefficient of determination values:\n\n* $0 \\leq R^{2} < 0.4$: poor model\n* $0.4 \\leq R^{2} < 0.7$: good model\n* $0.7 \\leq R^{2} \\leq 1.0$: great model\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"30%\"}\n![Karl Pearson](Karl_Pearson.png)\n:::\n\n::::\n\n## Model Statistics\n\nIn `R`, we can use `summary` to access **model statistics**.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lin_fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = LLV ~ year, data = liquor_df)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-38.89 -25.54 -12.44  32.01  40.91 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)  \n(Intercept) 17307.789   9047.707   1.913   0.0973 .\nyear           -8.550      4.483  -1.907   0.0982 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 34.73 on 7 degrees of freedom\nMultiple R-squared:  0.3419,\tAdjusted R-squared:  0.2479 \nF-statistic: 3.637 on 1 and 7 DF,  p-value: 0.09819\n```\n\n\n:::\n:::\n\n\n\nHere in SML 201, we will use the \"Adjusted R-squared\" value that accounts for the number of predictor variables.  Treat negative adjusted R-squared values simply as zero variation explained, and then look for the highest adjusted R-squared values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lin_fit)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2478815\n```\n\n\n:::\n:::\n\n\n\n\n# Historical Example\n\n## Francis Galton\n\n:::: {.columns}\n\n::: {.column width=\"40%\"}\n![Sir Francis Galton](Francis_Galton.png)\t\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"50%\"}\n* 1822 - 1911\n* cousin of Charles Darwin\n* correlation discovery\n\n    * 1846: August Bravais\n    * 1888: Francis Galton\n:::\n\n::::\n\n## Do tall parents have tall children?\n\nThe `Galton` data set in the `HistData` package has two variables\n\n* parents' height (see documentation for weighted formula)\n* child's height\n\nfor about 200 families\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheredity_df <- HistData::Galton\n```\n:::\n\n\n\n## Scatterplot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheredity_df |>\n  ggplot(aes(x = parent, y = child)) +\n  geom_point() +\n  geom_smooth(formula = \"y ~ x\", method = \"lm\", se = FALSE) +\n  labs(title = \"Do tall parents have tall children?\",\n       subtitle = \"Galton Survey of Heights\",\n       caption = \"SML 201\",\n       x = \"parent's heights (weighted average)\",\n       y = \"child's height\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_linear_regression_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n## Linear Model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlin_fit <- lm(child ~ parent, data = heredity_df)\n\n# slope\nsummary(lin_fit)$coefficients[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6462906\n```\n\n\n:::\n:::\n\n\n\nFor every one inch increase in parents' height, the child's height increases by about 0.65 inches.\n\n## Prediction\n\nIf the parents are 69 inches in height, what do we predict for the height of the child?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(lin_fit, newdata = data.frame(parent = 69))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       1 \n68.53558 \n```\n\n\n:::\n:::\n\n\n\nIf the parents are 58 inches in height, what do we predict for the height of the child?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(lin_fit, newdata = data.frame(parent = 58))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       1 \n61.42638 \n```\n\n\n:::\n:::\n\n\n\n\n## Regression to the Mean\n\nIn these early studies of heredity, Galton coined the phrase\n\n$$\\text{regression to the mean}$$\n\nand similar calculations have been called *regression* ever since.\n\n\n# Chemistry Example\n\n## Michaelis and Menton\n\n:::: {.columns}\n\n::: {.column width=\"40%\"}\n![Leonor Michaelis and Maud Menton](Michaelis_Menton.png)\t\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"50%\"}\nLeonor Michaelis\n\n* Berlin University (1897)\n\nMaud Menton\n\n* University of Toronto (1911)\n\n*Die Kinetik der Invertinwirkung* (1913)\n\n$$v = \\frac{V_{\\text{max}}[S]}{K_{m} + [S]}$$\n\n* $v$: reaction rate (micromolars per minute)\n* $[S]$: substrate concentration (micromolars)\n\n:::\n\n::::\n\n## Enzyme Kinetics\n\n:::: {.columns}\n\n::: {.column width=\"20%\"}\n![Essential Cell Biology](Alberts_cell_bio.png)\t\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"70%\"}\nThe reaction rates of the reaction S $\\rightarrow$ P catalyzed by enzyme E were determined under conditions such that only very little product was formed.  Compute the maximum reaction velocity asymptote $V_{\\text{max}}$ and the Michaelis-Menton constant $K_{m}$\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"giwoalcqpr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#giwoalcqpr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#giwoalcqpr thead, #giwoalcqpr tbody, #giwoalcqpr tfoot, #giwoalcqpr tr, #giwoalcqpr td, #giwoalcqpr th {\n  border-style: none;\n}\n\n#giwoalcqpr p {\n  margin: 0;\n  padding: 0;\n}\n\n#giwoalcqpr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#giwoalcqpr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#giwoalcqpr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#giwoalcqpr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#giwoalcqpr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#giwoalcqpr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#giwoalcqpr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#giwoalcqpr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#giwoalcqpr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#giwoalcqpr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#giwoalcqpr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#giwoalcqpr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#giwoalcqpr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#giwoalcqpr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#giwoalcqpr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#giwoalcqpr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#giwoalcqpr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#giwoalcqpr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#giwoalcqpr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#giwoalcqpr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#giwoalcqpr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#giwoalcqpr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#giwoalcqpr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#giwoalcqpr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#giwoalcqpr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#giwoalcqpr .gt_left {\n  text-align: left;\n}\n\n#giwoalcqpr .gt_center {\n  text-align: center;\n}\n\n#giwoalcqpr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#giwoalcqpr .gt_font_normal {\n  font-weight: normal;\n}\n\n#giwoalcqpr .gt_font_bold {\n  font-weight: bold;\n}\n\n#giwoalcqpr .gt_font_italic {\n  font-style: italic;\n}\n\n#giwoalcqpr .gt_super {\n  font-size: 65%;\n}\n\n#giwoalcqpr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#giwoalcqpr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#giwoalcqpr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#giwoalcqpr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#giwoalcqpr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#giwoalcqpr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#giwoalcqpr .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#giwoalcqpr .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#giwoalcqpr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_title gt_font_normal\" style>Michaelis Menton Experiment</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"2\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>reaction rate vs substrate concentration</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"S\">S</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"v\">v</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"S\" class=\"gt_row gt_center\" style=\"background-color: #FFC100;\">0.08</td>\n<td headers=\"v\" class=\"gt_row gt_center\" style=\"background-color: #D0CEF3;\">0.15</td></tr>\n    <tr><td headers=\"S\" class=\"gt_row gt_center\" style=\"background-color: #FFC100;\">0.12</td>\n<td headers=\"v\" class=\"gt_row gt_center\" style=\"background-color: #D0CEF3;\">0.21</td></tr>\n    <tr><td headers=\"S\" class=\"gt_row gt_center\" style=\"background-color: #FFC100;\">0.54</td>\n<td headers=\"v\" class=\"gt_row gt_center\" style=\"background-color: #D0CEF3;\">0.70</td></tr>\n    <tr><td headers=\"S\" class=\"gt_row gt_center\" style=\"background-color: #FFC100;\">1.23</td>\n<td headers=\"v\" class=\"gt_row gt_center\" style=\"background-color: #D0CEF3;\">1.10</td></tr>\n    <tr><td headers=\"S\" class=\"gt_row gt_center\" style=\"background-color: #FFC100;\">1.82</td>\n<td headers=\"v\" class=\"gt_row gt_center\" style=\"background-color: #D0CEF3;\">1.30</td></tr>\n    <tr><td headers=\"S\" class=\"gt_row gt_center\" style=\"background-color: #FFC100;\">2.72</td>\n<td headers=\"v\" class=\"gt_row gt_center\" style=\"background-color: #D0CEF3;\">1.50</td></tr>\n    <tr><td headers=\"S\" class=\"gt_row gt_center\" style=\"background-color: #FFC100;\">4.94</td>\n<td headers=\"v\" class=\"gt_row gt_center\" style=\"background-color: #D0CEF3;\">1.70</td></tr>\n    <tr><td headers=\"S\" class=\"gt_row gt_center\" style=\"background-color: #FFC100;\">10.00</td>\n<td headers=\"v\" class=\"gt_row gt_center\" style=\"background-color: #D0CEF3;\">1.80</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"> Die Kinetik der Invertinwirkung</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n:::\n\n::::\n\n## Scatterplot\n\n* reaction rate (lower case v)\n* substrate concentration (capital S)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMM_df |>\n  ggplot(aes(x = S, y = v)) +\n  geom_smooth(formula = \"y ~ x\", method = \"loess\", se = TRUE) +\n  geom_point(color = \"black\", size = 4) +\n  labs(title = \"Michaelis Menton Enzyme Kinetics Experiment\",\n       subtitle = \"reaction rate vs substrate concentration\",\n       caption = \"Essential Cell Biology\",\n       x = \"substrate concentration (micromolars)\",\n       y = \"reaction rate (micromolars per minute)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_linear_regression_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n\n## Transformation\n\n[Hans Lineweaver](https://carnotcycle.wordpress.com/2014/12/02/the-michaelis-menten-equation/) (George Washington Univ., 1934)\n\n$$v = \\frac{V_{\\text{max}}[S]}{K_{m} + [S]} \\quad\\rightarrow\\quad \\frac{1}{v} = \\frac{K_{m}}{V_{\\text{max}}} \\cdot \\frac{1}{[S]} + \\frac{1}{V_{\\text{max}}}$$\n\nThe reciprocal of the reaction rate is *linear* with respect to the reciprocal of the substrate concentration.\n\n## Double-Reciprocal Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMM_df <- MM_df |>\n  mutate(rS = 1/S,\n         rv = 1/v)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nMM_df |>\n  ggplot(aes(x = rS, y = rv)) +\n  geom_smooth(formula = \"y ~ x\", method = \"lm\", se = FALSE) +\n  geom_point(color = \"black\", size = 4) +\n  labs(title = \"Michaelis Menton Enzyme Kinetics Experiment\",\n       subtitle = \"Double Reciprocal Plot\",\n       caption = \"Essential Cell Biology\",\n       x = \"1/[S] (1/micromoles)\",\n       y = \"1/v (minutes per micromolar)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_linear_regression_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n## Linear Model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlin_fit <- lm(rv ~ rS, data = MM_df)\n```\n:::\n\n\n\n## Coefficient of Determination\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lin_fit)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9995051\n```\n\n\n:::\n:::\n\n\n\n## Extracting the Constants\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nslope <- lin_fit$coefficients[2]\nintercept <- lin_fit$coefficients[1]\n\nVmax <- 1/intercept\nKm <- slope * Vmax\n\nprint(paste(\"The Vmax asymptote is \", Vmax))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"The Vmax asymptote is  1.9894653306508\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(paste(\"The Michaelis-Menton constant is \", Km))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"The Michaelis-Menton constant is  0.991986524114476\"\n```\n\n\n:::\n:::\n\n\n\n## MM Experiment Revisited\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMM_df |>\n  ggplot(aes(x = S, y = v)) +\n  geom_smooth(formula = \"y ~ x\", method = \"loess\", se = TRUE) +\n  geom_point(color = \"black\", size = 4) +\n  geom_abline(slope = Km, intercept = 0, color = \"red\") +\n  geom_abline(slope = 0, intercept = Vmax, color = \"purple\") +\n  labs(title = \"Michaelis Menton Enzyme Kinetics Experiment\",\n       subtitle = \"maximum reaction velocity asymptote (purple)\\nMichaelis-Menton constant (red slope)\",\n       caption = \"Essential Cell Biology\",\n       x = \"substrate concentration (micromolars)\",\n       y = \"reaction rate (micromolars per minute)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](08_linear_regression_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n# Quo Vadimus?\n\n:::: {.columns}\n\n::: {.column width=\"45%\"}\n\n* Continue to complete BLTs and precept assignments\n* Project 1:\n\n    * Assigned! Sept 23\n    * Due: Oct 2\n    \n* Exam 1: Oct 10\n* Refer to weekly announcement for more info\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"45%\"}\n![coefficient of determination](xkcd_1725.png)\n\n* image source: [XKCD](https://xkcd.com/1725/)\n:::\n\n::::\n\n\n# Footnotes\n\n::: {.callout-note collapse=\"true\"}\n## (optional) Additional Resources\n\n\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Session Info\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4    \n [5] purrr_1.0.2     readr_2.1.5     tidyr_1.3.1     tibble_3.2.1   \n [9] ggplot2_3.5.1   tidyverse_2.0.0 HistData_0.9-1  gt_0.11.0      \n\nloaded via a namespace (and not attached):\n [1] sass_0.4.9         utf8_1.2.4         generics_0.1.3     xml2_1.3.6        \n [5] lattice_0.22-6     stringi_1.8.4      hms_1.1.3          digest_0.6.35     \n [9] magrittr_2.0.3     evaluate_0.24.0    grid_4.4.1         timechange_0.3.0  \n[13] RColorBrewer_1.1-3 fastmap_1.2.0      Matrix_1.7-0       jsonlite_1.8.8    \n[17] mgcv_1.9-1         fansi_1.0.6        viridisLite_0.4.2  scales_1.3.0      \n[21] cli_3.6.2          rlang_1.1.4        munsell_0.5.1      splines_4.4.1     \n[25] withr_3.0.1        yaml_2.3.8         tools_4.4.1        tzdb_0.4.0        \n[29] colorspace_2.1-1   vctrs_0.6.5        R6_2.5.1           lifecycle_1.0.4   \n[33] htmlwidgets_1.6.4  pkgconfig_2.0.3    pillar_1.9.0       gtable_0.3.5      \n[37] glue_1.7.0         xfun_0.44          tidyselect_1.2.1   rstudioapi_0.16.0 \n[41] knitr_1.48         farver_2.1.2       nlme_3.1-164       htmltools_0.5.8.1 \n[45] rmarkdown_2.27     labeling_0.4.3     compiler_4.4.1    \n```\n\n\n:::\n:::\n\n\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Example Callout Block\n\n`note`, `tip`, `warning`, `caution`, or `important`\n:::\n\n\n:::: {.columns}\n\n::: {.column width=\"45%\"}\n\t\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"45%\"}\n\n:::\n\n::::\n\n:::: {.panel-tabset}\n\n\n\n::::",
    "supporting": [
      "08_linear_regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}