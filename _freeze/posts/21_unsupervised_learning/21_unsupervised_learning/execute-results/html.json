{
  "hash": "bfc0a7c6c86eaa3ac78ddf28e883c4e1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"21: Unsupervised Learning\"\nauthor: \"Derek Sollberger\"\ndate: \"2024-11-21\"\nformat:\n  html:\n    toc: true\n    theme: cerulean\n---\n\n\n\n# SML 201\n\n## Start\n\n::: {.callout-note collapse=\"true\"}\n## Libraries and Loading the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"corrplot\")\nlibrary(\"DiagrammeR\")#easy coding of flowcharts\nlibrary(\"GGally\")    #extensions for ggplot\nlibrary(\"gt\")\nlibrary(\"sf\")\nlibrary(\"tidyclust\")\nlibrary(\"tidymodels\")\nlibrary(\"tidyverse\") #general framework for data wrangling\n\n# school colors\nprinceton_orange <- \"#E77500\"\nprinceton_black  <- \"#121212\"\n\n# data set: College Scorecard\n# college_raw <- readr::read_csv('Most-Recent-Cohorts-Institution.csv')\n# college_df <- college_raw |>\n#   select(INSTNM, UGDS,\n#          STABBR, LATITUDE, LONGITUDE,\n#          ADM_RATE,\n#          # SATMT75, SATWR75,\n#          C150_4, RET_FT4,\n#          MD_EARN_WNE_P10, ENDOWBEGIN) |>\n#   drop_na() |>\n#   filter(LONGITUDE > -125 & LONGITUDE < -67) |>\n#   filter(LATITUDE > 25 & LATITUDE < 49)\n# readr::write_csv(college_df, \"college_data.csv\")\ncollege_df <- readr::read_csv(\"college_data.csv\")\n# college_df <- readr::read_csv(\"https://raw.githubusercontent.com/dsollberger/sml201slides/refs/heads/main/data/college_data.csv\")\nstates_shp <- readr::read_rds(\"us_states_shp.rds\")\n```\n:::\n\n\n\n:::\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n* **Goal**: Explore topics in unsupervised learning\n\n\n:::\n\n::: {.column width=\"10%\"}\n\n:::\n\n::: {.column width=\"40%\"}\n* **Objectives**: \n\n- clustering\n- workflows\n\n:::\n\n::::\n\n## Data: College Scorecard\n\nToday's data comes from [College Scorecard](https://collegescorecard.ed.gov/data).\n\n* `INSTNM`: institution name\n* `UGDS`: undergraduate enrollment (number of students)\n* `LATITUDE`\n* `LONGITUDE`\n* `ADM_RATE`: admission rate\n* `C150_4`: completion rate (at 150% of expected time for 4-year degrees)\n* `RET_FT4`: retention rate (full-time students, 4-year institutions)\n* `MD_EARN_WNE_P10`: median earnings, 10 years after graduation (USD)\n* `ENDOWBEGIN`: endowment (beginning of school year)\n\n## Correlation Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollege_df |>\n  select_if(is.numeric) |>\n  cor(use = \"pairwise.complete.obs\") |>\n  corrplot(method = \"ellipse\",\n           order = \"FPC\",\n           type = \"upper\")\n```\n\n::: {.cell-output-display}\n![](21_unsupervised_learning_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n\n# k-means Clustering\n\n## Scene\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstates_shp |>\n  ggplot() +\n  geom_sf(color = \"gray80\", fill = \"white\") +\n  geom_point(aes(x = LONGITUDE, y = LATITUDE, \n                 color = STABBR),\n             data = college_df) +\n  labs(title = \"American Universities\",\n       subtitle = \"A selection of insitutions in the continental USA\",\n       caption = \"Source: College Scorecard\",\n       x = \"\", y = \"\") +\n  theme_minimal(base_size = 14) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](21_unsupervised_learning_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n## A first foray\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(20241121)\nk4_fit <- k_means(num_clusters = 4) |>\n  set_engine(\"stats\") |>\n  fit(~ LATITUDE + LONGITUDE, data = college_df)\n```\n:::\n\n\n\n## Centroids\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstates_shp |>\n  ggplot() +\n  geom_sf(color = \"gray80\", fill = \"white\") +\n  geom_point(aes(x = LONGITUDE, y = LATITUDE),\n             color = \"gray60\",\n             data = college_df) +\n  geom_point(aes(x = LONGITUDE, y = LATITUDE, \n                 color = .cluster),\n             data = extract_centroids(k4_fit),\n             size = 7) +\n  labs(title = \"Centroids\",\n       subtitle = \"The clusters will be picked by distance to the nearest centroid\",\n       caption = \"Source: College Scorecard\",\n       x = \"\", y = \"\") +\n  scale_color_brewer(palette = \"Dark2\") +\n  theme_minimal(base_size = 14) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](21_unsupervised_learning_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## Clusters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncluster_df <- college_df |>\n  mutate(cluster_num = extract_cluster_assignment(k4_fit) |>\n           pull())\n\nstates_shp |>\n  ggplot() +\n  geom_sf(color = \"gray80\", fill = \"white\") +\n  geom_point(aes(x = LONGITUDE, y = LATITUDE, \n                 color = cluster_num),\n             data = cluster_df) +\n  labs(title = \"Clusters\",\n       subtitle = \"k = 4\",\n       caption = \"Source: College Scorecard\",\n       x = \"\", y = \"\") +\n  scale_color_brewer(palette = \"Dark2\") +\n  theme_minimal(base_size = 14) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](21_unsupervised_learning_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n::: {.callout-note}\n## Considerations\n\n1. How do we place the centroids? Randomly?\n2. How do we pick the number of clusters?\n:::\n\n\n# Error Ratios\n\n## Try several arrangements\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nN <- 10 #max possible number of clusters\nk_vals <- 1:N\nerr_ratios <- rep(NA, N)\n\nfor(i in 1:N){\n  kmeans_fit <- k_means(num_clusters = k_vals[i]) |>\n    set_engine(\"stats\") |>\n    fit(~ LATITUDE + LONGITUDE, data = college_df)\n  err_ratios[i] <- kmeans_fit$fit$tot.withinss / kmeans_fit$fit$totss\n}\n```\n:::\n\n\n\n## Scree Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_for_graph <- data.frame(num_clusters = 1:N,\n                           err_ratios)\n\ndf_for_graph |>\n  ggplot() +\n  geom_point(aes(x = factor(num_clusters), y = err_ratios),\n             size = 3) +\n  geom_line(aes(x = num_clusters, y = err_ratios)) +\n  labs(title = \"Scree Plot\",\n       subtitle = \"Aiming to choose the number of clusters\",\n       caption = \"SML 201\",\n       x = \"number of clusters\",\n       y = \"within/total SSE ratio\") +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![](21_unsupervised_learning_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n# Workflow\n\n::::: {.panel-tabset}\n\n## Flowchart\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"DiagrammeR html-widget html-fill-item\" id=\"htmlwidget-9e33fdc5c963656ef691\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-9e33fdc5c963656ef691\">{\"x\":{\"diagram\":\"\\ngraph LR\\n\\ndata_frame --> cross_validation\\ndata_frame --> recipe\\nrecipe --> workflow\\nspec --> workflow\\ngrid_search --> tuning\\nworkflow --> tuning\\ncross_validation --> tuning\\n\\ntuning --> eval_metrics\\n\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n## Mermaid code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDiagrammeR::mermaid(\"\ngraph LR\n\ndata_frame --> cross_validation\ndata_frame --> recipe\nrecipe --> workflow\nspec --> workflow\ngrid_search --> tuning\nworkflow --> tuning\ncross_validation --> tuning\n\ntuning --> eval_metrics\n\")\n```\n:::\n\n\n\n:::::\n\n## Tidymodels\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# cross-validation folds\ncollege_cv <- vfold_cv(college_df, v = 10)\n\n# specification\ncollege_spec <- k_means(num_clusters = tune())\n\n# recipe\ncollege_recipe <- recipe(~., data = college_df |>\n                         select_if(is.numeric)) |>\n  step_normalize()\n\n# workflow\ncollege_workflow <- workflow(college_recipe, college_spec)\n\n# parameter grid\nkvals_grid <- grid_regular(num_clusters(), levels = 10)\n\n# tuning\ntune_results <- tune_cluster(\n  college_workflow,\n  resamples = college_cv,\n  grid = kvals_grid,\n  metrics = cluster_metric_set(sse_within_total, sse_total, sse_ratio)\n)\n```\n:::\n\n\n\n## Scree Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntune_results |>\n  collect_metrics() |>\n  filter(.metric == \"sse_ratio\") |>\n  ggplot(aes(x = num_clusters, y = mean)) +\n  geom_point(aes(x = factor(num_clusters), y = mean),\n             size = 3) +\n  geom_line() +\n  labs(title = \"Scree Plot\",\n       subtitle = \"Aiming to choose the number of clusters\",\n       caption = \"SML 201\",\n       x = \"number of clusters\",\n       y = \"within/total SSE ratio\") +\n  theme_minimal(base_size = 14)\n```\n\n::: {.cell-output-display}\n![](21_unsupervised_learning_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n# Pairs Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollege_df |>\n  select_if(is.numeric) |>\n  GGally::ggpairs(title = \"American Universities\")\n```\n\n::: {.cell-output-display}\n![](21_unsupervised_learning_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(20241121)\nk4_fit <- k_means(num_clusters = 4) |>\n  set_engine(\"stats\") |>\n  fit(~., data = college_df |>\n        select_if(is.numeric))\ncollege_k4 <- college_df |>\n  mutate(cluster_num = extract_cluster_assignment(k4_fit) |>\n           pull())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncollege_k4 |>\n  GGally::ggpairs(columns = c(2, 6:9),\n                  aes(color = cluster_num)) +\n  scale_color_brewer(palette = \"Dark2\")\n```\n\n::: {.cell-output-display}\n![](21_unsupervised_learning_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n# Classification\n\nOut of interest, we now seek smaller cluster sizes (i.e. fewer colleges in each cluster), so let us explore an arrangement with $k = 10$ clusters.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(20241121)\nk10_fit <- k_means(num_clusters = 10) |>\n  set_engine(\"stats\") |>\n  fit(~., data = college_df |>\n        select_if(is.numeric) |>\n        mutate(across(where(is.numeric), scale)))\ncollege_k10 <- college_df |>\n  mutate(cluster_num = extract_cluster_assignment(k10_fit) |>\n           pull())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_clust_id <- college_k10 |> \n  filter(INSTNM == \"Princeton University\") |>\n  pull(cluster_num)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncollege_k10 |>\n  filter(cluster_num == p_clust_id)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 11\n  INSTNM  UGDS STABBR LATITUDE LONGITUDE ADM_RATE C150_4 RET_FT4 MD_EARN_WNE_P10\n  <chr>  <dbl> <chr>     <dbl>     <dbl>    <dbl>  <dbl>   <dbl>           <dbl>\n1 Yale …  6639 CT         41.3     -72.9   0.0457  0.978   0.981          100533\n2 Harva…  7973 MA         42.4     -71.1   0.0324  0.978   0.977          101817\n3 Massa…  4638 MA         42.4     -71.1   0.0396  0.949   0.990          143372\n4 Princ…  5527 NJ         40.3     -74.7   0.057   0.973   0.970          110066\n5 Unive… 10572 PA         40.0     -75.2   0.065   0.961   0.984          111371\n6 Stanf…  7761 CA         37.4    -122.    0.0368  0.951   0.983          124080\n# ℹ 2 more variables: ENDOWBEGIN <dbl>, cluster_num <fct>\n```\n\n\n:::\n:::\n\n\n::::: {.panel-tabset}\n\n## table\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ffhgkbbwqy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ffhgkbbwqy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ffhgkbbwqy thead, #ffhgkbbwqy tbody, #ffhgkbbwqy tfoot, #ffhgkbbwqy tr, #ffhgkbbwqy td, #ffhgkbbwqy th {\n  border-style: none;\n}\n\n#ffhgkbbwqy p {\n  margin: 0;\n  padding: 0;\n}\n\n#ffhgkbbwqy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ffhgkbbwqy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ffhgkbbwqy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ffhgkbbwqy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ffhgkbbwqy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ffhgkbbwqy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ffhgkbbwqy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ffhgkbbwqy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ffhgkbbwqy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ffhgkbbwqy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ffhgkbbwqy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ffhgkbbwqy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ffhgkbbwqy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ffhgkbbwqy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ffhgkbbwqy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ffhgkbbwqy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ffhgkbbwqy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ffhgkbbwqy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ffhgkbbwqy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ffhgkbbwqy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ffhgkbbwqy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ffhgkbbwqy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ffhgkbbwqy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ffhgkbbwqy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ffhgkbbwqy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ffhgkbbwqy .gt_left {\n  text-align: left;\n}\n\n#ffhgkbbwqy .gt_center {\n  text-align: center;\n}\n\n#ffhgkbbwqy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ffhgkbbwqy .gt_font_normal {\n  font-weight: normal;\n}\n\n#ffhgkbbwqy .gt_font_bold {\n  font-weight: bold;\n}\n\n#ffhgkbbwqy .gt_font_italic {\n  font-style: italic;\n}\n\n#ffhgkbbwqy .gt_super {\n  font-size: 65%;\n}\n\n#ffhgkbbwqy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ffhgkbbwqy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ffhgkbbwqy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ffhgkbbwqy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ffhgkbbwqy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ffhgkbbwqy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ffhgkbbwqy .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ffhgkbbwqy .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ffhgkbbwqy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"7\" class=\"gt_heading gt_title gt_font_normal\" style>The Princeton Cluster</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"7\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>of similar universities</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"university\">university</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"state\">state</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"enrollment\">enrollment</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"admit_rate\">admit_rate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"grad_rate\">grad_rate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"retention\">retention</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"income\">income</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"university\" class=\"gt_row gt_center\">Harvard University</td>\n<td headers=\"state\" class=\"gt_row gt_center\">MA</td>\n<td headers=\"enrollment\" class=\"gt_row gt_center\">7973</td>\n<td headers=\"admit_rate\" class=\"gt_row gt_center\">3.24</td>\n<td headers=\"grad_rate\" class=\"gt_row gt_center\">97.77</td>\n<td headers=\"retention\" class=\"gt_row gt_center\">97.69</td>\n<td headers=\"income\" class=\"gt_row gt_center\">101817</td></tr>\n    <tr><td headers=\"university\" class=\"gt_row gt_center\">Massachusetts Institute of Technology</td>\n<td headers=\"state\" class=\"gt_row gt_center\">MA</td>\n<td headers=\"enrollment\" class=\"gt_row gt_center\">4638</td>\n<td headers=\"admit_rate\" class=\"gt_row gt_center\">3.96</td>\n<td headers=\"grad_rate\" class=\"gt_row gt_center\">94.94</td>\n<td headers=\"retention\" class=\"gt_row gt_center\">98.98</td>\n<td headers=\"income\" class=\"gt_row gt_center\">143372</td></tr>\n    <tr><td headers=\"university\" class=\"gt_row gt_center\" style=\"background-color: #E77500; color: #121212; font-weight: bold;\">Princeton University</td>\n<td headers=\"state\" class=\"gt_row gt_center\" style=\"background-color: #E77500; color: #121212; font-weight: bold;\">NJ</td>\n<td headers=\"enrollment\" class=\"gt_row gt_center\" style=\"background-color: #E77500; color: #121212; font-weight: bold;\">5527</td>\n<td headers=\"admit_rate\" class=\"gt_row gt_center\" style=\"background-color: #E77500; color: #121212; font-weight: bold;\">5.70</td>\n<td headers=\"grad_rate\" class=\"gt_row gt_center\" style=\"background-color: #E77500; color: #121212; font-weight: bold;\">97.32</td>\n<td headers=\"retention\" class=\"gt_row gt_center\" style=\"background-color: #E77500; color: #121212; font-weight: bold;\">97.05</td>\n<td headers=\"income\" class=\"gt_row gt_center\" style=\"background-color: #E77500; color: #121212; font-weight: bold;\">110066</td></tr>\n    <tr><td headers=\"university\" class=\"gt_row gt_center\">Stanford University</td>\n<td headers=\"state\" class=\"gt_row gt_center\">CA</td>\n<td headers=\"enrollment\" class=\"gt_row gt_center\">7761</td>\n<td headers=\"admit_rate\" class=\"gt_row gt_center\">3.68</td>\n<td headers=\"grad_rate\" class=\"gt_row gt_center\">95.11</td>\n<td headers=\"retention\" class=\"gt_row gt_center\">98.31</td>\n<td headers=\"income\" class=\"gt_row gt_center\">124080</td></tr>\n    <tr><td headers=\"university\" class=\"gt_row gt_center\">University of Pennsylvania</td>\n<td headers=\"state\" class=\"gt_row gt_center\">PA</td>\n<td headers=\"enrollment\" class=\"gt_row gt_center\">10572</td>\n<td headers=\"admit_rate\" class=\"gt_row gt_center\">6.50</td>\n<td headers=\"grad_rate\" class=\"gt_row gt_center\">96.09</td>\n<td headers=\"retention\" class=\"gt_row gt_center\">98.37</td>\n<td headers=\"income\" class=\"gt_row gt_center\">111371</td></tr>\n    <tr><td headers=\"university\" class=\"gt_row gt_center\">Yale University</td>\n<td headers=\"state\" class=\"gt_row gt_center\">CT</td>\n<td headers=\"enrollment\" class=\"gt_row gt_center\">6639</td>\n<td headers=\"admit_rate\" class=\"gt_row gt_center\">4.57</td>\n<td headers=\"grad_rate\" class=\"gt_row gt_center\">97.81</td>\n<td headers=\"retention\" class=\"gt_row gt_center\">98.10</td>\n<td headers=\"income\" class=\"gt_row gt_center\">100533</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"7\"> Source: College Scorecard</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## gt\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollege_k10 |>\n  filter(cluster_num == p_clust_id) |>\n  select(INSTNM, STABBR, UGDS,\n         ADM_RATE, C150_4, RET_FT4,\n         MD_EARN_WNE_P10) |>\n  rename(university = INSTNM,\n         state = STABBR,\n         enrollment = UGDS,\n         income = MD_EARN_WNE_P10) |>\n  mutate(admit_rate = 100*ADM_RATE,\n         grad_rate = 100*C150_4,\n         retention = 100*RET_FT4,) |>\n  select(university, state, enrollment,\n         admit_rate, grad_rate, retention,\n         income) |>\n  arrange(university) |>\n  gt() |>\n  cols_align(align = \"center\") |>\n  tab_footnote(footnote = \"Source: College Scorecard\") |>\n  tab_header(\n    title = \"The Princeton Cluster\",\n    subtitle = \"of similar universities\"\n  ) |>\n  tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_column_labels()\n  ) |>\n  tab_style(\n    style = list(cell_fill(color = \"#E77500\"),\n                 cell_text(color = \"#121212\",\n                           weight = \"bold\")),\n    locations = cells_body(rows = university == \"Princeton University\")\n  )\n```\n:::\n\n\n\n\n:::::\n\n\n\n\n\n# Quo Vadimus?\n\n:::: {.columns}\n\n::: {.column width=\"40%\"}\n* Precept 10\n* CLO Assessment\n* Exam 2 (December 5)\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"50%\"}\n\n\n:::\n\n::::\n\n\n# Footnotes\n\n::: {.callout-note collapse=\"true\"}\n## (optional) Additional Resources\n\n\n\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Session Info\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] lubridate_1.9.3    forcats_1.0.0      stringr_1.5.1      readr_2.1.5       \n [5] tidyverse_2.0.0    yardstick_1.3.1    workflowsets_1.1.0 workflows_1.1.4   \n [9] tune_1.2.1         tidyr_1.3.1        tibble_3.2.1       rsample_1.2.1     \n[13] recipes_1.0.10     purrr_1.0.2        parsnip_1.2.1      modeldata_1.4.0   \n[17] infer_1.0.7        dplyr_1.1.4        dials_1.3.0        scales_1.3.0      \n[21] broom_1.0.7        tidymodels_1.2.0   tidyclust_0.2.3    sf_1.0-17         \n[25] gt_0.11.1          GGally_2.2.1       ggplot2_3.5.1      DiagrammeR_1.0.11 \n[29] corrplot_0.94     \n\nloaded via a namespace (and not attached):\n [1] DBI_1.2.3           rlang_1.1.4         magrittr_2.0.3     \n [4] flexclust_1.4-2     furrr_0.3.1         e1071_1.7-14       \n [7] compiler_4.4.1      vctrs_0.6.5         RcppZiggurat_0.1.6 \n[10] lhs_1.2.0           crayon_1.5.3        pkgconfig_2.0.3    \n[13] fastmap_1.2.0       ellipsis_0.3.2      backports_1.5.0    \n[16] labeling_0.4.3      utf8_1.2.4          rmarkdown_2.28     \n[19] prodlim_2024.06.25  tzdb_0.4.0          bit_4.5.0          \n[22] Rfast_2.1.0         modeltools_0.2-23   xfun_0.48          \n[25] jsonlite_1.8.8      parallel_4.4.1      R6_2.5.1           \n[28] stringi_1.8.4       RColorBrewer_1.1-3  parallelly_1.37.1  \n[31] rpart_4.1.23        Rcpp_1.0.12         iterators_1.0.14   \n[34] knitr_1.48          future.apply_1.11.2 Matrix_1.7-0       \n[37] splines_4.4.1       nnet_7.3-19         timechange_0.3.0   \n[40] tidyselect_1.2.1    rstudioapi_0.17.0   yaml_2.3.8         \n[43] timeDate_4032.109   codetools_0.2-20    listenv_0.9.1      \n[46] lattice_0.22-6      plyr_1.8.9          withr_3.0.2        \n[49] evaluate_1.0.1      archive_1.1.8       future_1.33.2      \n[52] survival_3.6-4      RcppParallel_5.1.9  ggstats_0.7.0      \n[55] units_0.8-5         proxy_0.4-27        xml2_1.3.6         \n[58] pillar_1.9.0        KernSmooth_2.23-24  stats4_4.4.1       \n[61] foreach_1.5.2       generics_0.1.3      vroom_1.6.5        \n[64] hms_1.1.3           munsell_0.5.1       globals_0.16.3     \n[67] class_7.3-22        glue_1.8.0          tools_4.4.1        \n[70] data.table_1.16.2   modelenv_0.2.0      gower_1.0.1        \n[73] visNetwork_2.1.2    grid_4.4.1          ipred_0.9-14       \n[76] colorspace_2.1-1    cli_3.6.3           DiceDesign_1.10    \n[79] fansi_1.0.6         lava_1.8.0          gtable_0.3.5       \n[82] GPfit_1.0-8         sass_0.4.9          digest_0.6.35      \n[85] classInt_0.4-10     farver_2.1.2        htmlwidgets_1.6.4  \n[88] htmltools_0.5.8.1   lifecycle_1.0.4     hardhat_1.4.0      \n[91] bit64_4.5.2         MASS_7.3-60.2      \n```\n\n\n:::\n:::\n\n\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Example Callout Block\n\n`note`, `tip`, `warning`, `caution`, or `important`\n:::\n\n\n:::: {.columns}\n\n::: {.column width=\"45%\"}\n\t\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"45%\"}\n\n:::\n\n::::\n\n::::: {.panel-tabset}\n\n\n\n:::::",
    "supporting": [
      "21_unsupervised_learning_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/d3-3.3.8/d3.min.js\"></script>\n<script src=\"../../site_libs/dagre-0.4.0/dagre-d3.min.js\"></script>\n<link href=\"../../site_libs/mermaid-0.3.0/dist/mermaid.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/mermaid-0.3.0/dist/mermaid.slim.min.js\"></script>\n<link href=\"../../site_libs/DiagrammeR-styles-0.2/styles.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/chromatography-0.1/chromatography.js\"></script>\n<script src=\"../../site_libs/DiagrammeR-binding-1.0.11/DiagrammeR.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}